"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[80],{6080:function(e,t,a){a.r(t),a.d(t,{default:function(){return r}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"myHome"},[t("div",{staticStyle:{padding:"20px"}},[t("el-breadcrumb",{attrs:{separator:"/"}},[t("el-breadcrumb-item",{attrs:{to:{path:""}}},[t("span",{staticStyle:{color:"white"}},[e._v("资源管理")])]),t("el-breadcrumb-item",[t("span",{staticStyle:{color:"white"}},[e._v("待审核资源")])])],1),t("div",[t("div",{staticStyle:{padding:"10px",float:"left"}},[t("el-input",{staticClass:"ml-5",staticStyle:{width:"200px"},attrs:{placeholder:"请输入资源包名","suffix-icon":"el-icon-search"},model:{value:e.packageName,callback:function(t){e.packageName=t},expression:"packageName"}})],1),t("div",{staticStyle:{padding:"10px",float:"left"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入上传者名称","suffix-icon":"el-icon-search"},model:{value:e.packageAuthor,callback:function(t){e.packageAuthor=t},expression:"packageAuthor"}})],1),t("div",{staticStyle:{padding:"10px",float:"left"}},[t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.load}},[e._v("搜索")])],1),t("div",{staticStyle:{padding:"10px",float:"left"}},[t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:e.clearFilter}},[e._v("重置筛选条件")])],1),t("div",{staticStyle:{padding:"10px",float:"left"}},[t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:e.load}},[e._v("刷新列表")])],1)]),t("el-table",{staticStyle:{"font-size":"15px"},attrs:{data:e.tableData,border:"",stripe:"","header-cell-style":{background:"#42b983",color:"white"},stripe:!0,"highlight-current-row":!0,"max-height":"600"}},[t("el-table-column",{attrs:{prop:"pendingReviewPackageName",label:"资源包名","min-width":"20%",resizable:!1}}),t("el-table-column",{attrs:{prop:"packageCnName",label:"资源中文名","min-width":"15%",resizable:!1}}),t("el-table-column",{attrs:{prop:"pendingReviewPackageType",label:"资源包类型","min-width":"10%",resizable:!1}}),t("el-table-column",{attrs:{prop:"pendingReviewPackageAuthor",label:"上传者","min-width":"10%",resizable:!1}}),t("el-table-column",{attrs:{prop:"pendingReviewPackageTime",label:"上传时间","min-width":"15%",resizable:!1}}),t("el-table-column",{attrs:{prop:"pendingReviewPackageStatus",label:"资源包状态","min-width":"10%",resizable:!1},scopedSlots:e._u([{key:"default",fn:function(a){return["待审核"===a.row.pendingReviewPackageStatus?t("span",[t("i",{staticClass:"el-icon-warning",staticStyle:{color:"red"}}),e._v("待审核 ")]):e._e(),"待发布"===a.row.pendingReviewPackageStatus?t("span",[t("i",{staticClass:"el-icon-success",staticStyle:{color:"#13ce66"}}),e._v("扫描完成，待发布 ")]):e._e(),"已拒绝"===a.row.pendingReviewPackageStatus?t("span",[t("i",{staticClass:"el-icon-remove",staticStyle:{color:"#8c939d"}}),e._v("审核拒绝 ")]):e._e(),"已忽略"===a.row.pendingReviewPackageStatus?t("span",[t("i",{staticClass:"el-icon-remove",staticStyle:{color:"#8c939d"}}),e._v("已忽略 ")]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"",label:"操作","min-width":"40%",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(t){return e.getPackageDetailInfoButton(a.row.pendingReviewPackageId,a.row.pendingReviewPackageName,a.row.connectedDetailInfoId)}}},[t("i",{staticClass:"el-icon-view"},[e._v("查看详情")])]),t("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){return e.checkPackageButton(a.row.pendingReviewPackageId,a.row.pendingReviewPackageName,a.row.pendingReviewPackageStatus,a.row.connectedDetailInfoId)}}},[t("i",{staticClass:"el-icon-question"},[e._v("安全检查")])]),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.refusePackageButton(a.row.pendingReviewPackageId,a.row.pendingReviewPackageName,a.row.pendingReviewPackageStatus,a.row.connectedDetailInfoId)}}},[t("i",{staticClass:"el-icon-errort"},[e._v("拒绝")])]),t("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(t){return e.publicPackageButton(a.row.pendingReviewPackageId,a.row.pendingReviewPackageName,a.row.pendingReviewPackageStatus,a.row.connectedDetailInfoId)}}},[t("i",{staticClass:"el-icon-s-promotion"},[e._v("发布")])])]}}])})],1),t("el-dialog",{attrs:{title:"资源包基础信息",visible:e.packageDetailDialogFormVisible},on:{"update:visible":function(t){e.packageDetailDialogFormVisible=t}}},[t("el-card",[t("div",{staticStyle:{"text-align":"left"},attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(this.packageNameInDialog))])]),t("div",{staticStyle:{"text-align":"left",color:"black","padding-left":"10px","font-size":"larger"}},[t("span",{staticStyle:{"padding-right":"20px"}},[e._v("资源包名:")]),t("span",{staticStyle:{"font-weight":"bold","padding-right":"10px",color:"#1482f0","font-size":"larger"}},[e._v(e._s(this.packageDetailInfo.connectedPackageOriginalFileName))])]),t("div",{staticStyle:{"text-align":"left",color:"black","padding-left":"10px","font-size":"larger"}},[t("span",{staticStyle:{"padding-right":"20px"}},[e._v("资源包大小:")]),t("span",{staticStyle:{"font-weight":"bold","padding-right":"10px",color:"#1482f0","font-size":"larger"}},[e._v(e._s(this.packageDetailInfo.connectedPackageSize))])]),t("div",{staticStyle:{"text-align":"left",color:"black","padding-left":"10px","font-size":"larger"}},[t("span",{staticStyle:{"padding-right":"20px"}},[e._v("服务中文名:")]),t("span",{staticStyle:{"font-weight":"bold","padding-right":"10px",color:"#1482f0","font-size":"larger"}},[e._v(e._s(this.packageDetailInfo.softwareCnName))])]),t("div",{staticStyle:{"text-align":"left",color:"black","padding-left":"10px","font-size":"larger"}},[t("span",{staticStyle:{"padding-right":"20px"}},[e._v("运行环境:")]),t("span",{staticStyle:{"font-weight":"bold","padding-right":"10px",color:"#1482f0","font-size":"larger"}},[e._v(e._s(this.packageDetailInfo.softwareEnvironment))])]),t("div",{staticStyle:{"text-align":"left",color:"black","padding-left":"10px","font-size":"larger"}},[t("span",{staticStyle:{"padding-right":"20px"}},[e._v("服务版本号:")]),t("span",{staticStyle:{"font-weight":"bold","padding-right":"10px",color:"#1482f0","font-size":"larger"}},[e._v(e._s(this.packageDetailInfo.softwareVersion))])]),t("div",{staticStyle:{"text-align":"left",color:"black","padding-left":"10px","font-size":"larger"}},[t("span",{staticStyle:{"padding-right":"20px"}},[e._v("服务唯一标识:")]),t("span",{staticStyle:{"font-weight":"bold","padding-right":"10px",color:"#1482f0","font-size":"larger"}},[e._v(e._s(this.packageDetailInfo.softwareUniqueName))])]),t("div",{staticStyle:{"text-align":"left",color:"black","padding-left":"10px","font-size":"larger"}},[t("span",{staticStyle:{"padding-right":"20px"}},[e._v("容器服务CPU需求(cpuRequests):")]),t("span",{staticStyle:{"font-weight":"bold","padding-right":"10px",color:"#1482f0","font-size":"larger"}},[e._v(e._s(this.packageDetailInfo.cpuRequests))])]),t("div",{staticStyle:{"text-align":"left",color:"black","padding-left":"10px","font-size":"larger"}},[t("span",{staticStyle:{"padding-right":"20px"}},[e._v("容器服务内存需求(memoryRequests):")]),t("span",{staticStyle:{"font-weight":"bold","padding-right":"10px",color:"#1482f0","font-size":"larger"}},[e._v(e._s(this.packageDetailInfo.memoryRequests))])]),t("div",{staticStyle:{"text-align":"left",color:"black","padding-left":"10px","font-size":"larger"}},[t("span",{staticStyle:{"padding-right":"20px"}},[e._v("服务开发者:")]),t("span",{staticStyle:{"font-weight":"bold","padding-right":"10px",color:"#1482f0","font-size":"larger"}},[e._v(e._s(this.packageDetailInfo.developerName))])]),t("div",{staticStyle:{"text-align":"left",color:"black","padding-left":"10px","font-size":"larger"}},[t("span",{staticStyle:{"padding-right":"20px"}},[e._v("服务开发单位:")]),t("span",{staticStyle:{"font-weight":"bold","padding-right":"10px",color:"#1482f0","font-size":"larger"}},[e._v(e._s(this.packageDetailInfo.developerGroup))])]),t("div",{staticStyle:{"text-align":"left",color:"black","padding-left":"10px","font-size":"larger"}},[t("span",{staticStyle:{"padding-right":"20px"}},[e._v("联系方式:")]),t("span",{staticStyle:{"font-weight":"bold","padding-right":"10px",color:"#1482f0","font-size":"larger"}},[e._v(e._s(this.packageDetailInfo.developerPhone))])])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.packageDetailDialogFormVisible=!1}}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"资源包安全扫描",visible:e.checkPackageDialogFormVisible,"close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(t){e.checkPackageDialogFormVisible=t}}},[t("el-card",[t("div",{staticStyle:{"text-align":"left"},attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(this.packageNameInDialog))])]),t("div",[e._v("扫描进度")]),t("el-progress",{staticStyle:{"padding-left":"10px","padding-right":"10px","padding-bottom":"20px",color:"#eb194d"},attrs:{"text-inside":!0,"stroke-width":26,percentage:this.checkProgressValue,color:e.customColors}}),t("div",{staticStyle:{"padding-top":"20px"}},[e._v("扫描引擎版本：0.1")])],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"danger"},on:{click:e.cancelCheckPackageButton}},[e._v("取 消")]),100===this.checkProgressValue?t("el-button",{attrs:{type:"primary"},on:{click:e.checkFinishButton}},[e._v("完 成")]):e._e()],1)],1),t("el-dialog",{attrs:{title:"中断扫描",visible:e.cancelCheckPackageDialogFormVisible,"close-on-click-modal":!1,width:"30%"},on:{"update:visible":function(t){e.cancelCheckPackageDialogFormVisible=t}}},[t("span",[e._v("此操作将中断资源包扫描，系统不会记录已扫描的进度和信息。")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.continueCheckPackageButton}},[e._v("继续扫描")]),t("el-button",{attrs:{type:"danger"},on:{click:e.yesCancelCheckPackageButton}},[e._v("终止扫描")])],1)]),t("el-dialog",{attrs:{title:"拒绝此资源包",visible:e.refusePackageDialogFormVisible},on:{"update:visible":function(t){e.refusePackageDialogFormVisible=t}}},[t("el-card",[t("div",{staticStyle:{"text-align":"left"},attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(this.packageNameInDialog))]),t("span",[e._v(e._s(this.packageIdInDialog))])])]),t("span",[t("i",{staticClass:"el-icon-warning"}),e._v("拒绝资源包后，将无法对其再进行查看详情、安全检查、发布等操作，确认？")]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"info"},on:{click:function(t){e.refusePackageDialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"danger"},on:{click:e.refusePackage}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"发布资源包",visible:e.publishPackageDialogFormVisible},on:{"update:visible":function(t){e.publishPackageDialogFormVisible=t}}},[t("el-card",[t("div",{staticStyle:{"text-align":"left"},attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(this.packageNameInDialog))])])]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"info"},on:{click:function(t){e.publishPackageDialogFormVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.publishPackage}},[e._v("确 定")])],1)],1),t("div",{staticStyle:{padding:"10px 0","background-color":"white"}},[t("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[2,5,10,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])},s=[],l={name:"PendingReviewPackage",data(){return{tableData:[],pageNum:1,pageSize:10,total:0,packageName:"",packageAuthor:"",user:window.sessionStorage.getItem("userAccount"),packageIdInDialog:"",packageNameInDialog:"",packageStatusInDialog:"",packageConnectedDetailId:"",packageDetailDialogFormVisible:!1,packageDetailInfo:"",checkPackageDialogFormVisible:!1,checkProgressValue:0,cancelCheckPackageDialogFormVisible:!1,checkTimer:"",customColors:[{color:"#708090",percentage:20},{color:"#f56c6c",percentage:40},{color:"#e6a23c",percentage:60},{color:"#1989fa",percentage:80},{color:"#5cb87a",percentage:100}],refusePackageDialogFormVisible:!1,publishPackageDialogFormVisible:!1}},created(){this.load()},destroyed(){clearInterval(this.checkTimer)},methods:{async load(){await this.request.get("/pendingReviewPackage/page",{params:{pageNum:this.pageNum,pageSize:this.pageSize,packageName:this.packageName,packageAuthor:this.packageAuthor}}).then((e=>{console.log(e),this.tableData=e.records,this.total=e.total})),this.getPendingReviewPackageAsideNumber(),this.getPublishedPackageAsideNumber(),this.getRemovedPackageAsideNumber()},getPendingReviewPackageAsideNumber(){this.request.get("/pendingReviewPackage/getPendingPackageAsideNumber").then((e=>{this.$store.commit("setPendingPackageNumber",e.data)}))},getPublishedPackageAsideNumber(){this.request.get("/publishedPackage/getPublishedPackageAsideNumber").then((e=>{this.$store.commit("setPublishedPackageNumber",e.data)}))},getRemovedPackageAsideNumber(){this.request.get("/removedPackage/getRemovedPackageAsideNumber").then((e=>{this.$store.commit("setRemovedPackageNumber",e.data)}))},handleSizeChange(e){console.log(e),this.pageSize=e,this.load()},handleCurrentChange(e){console.log(e),this.pageNum=e,this.load()},clearFilter(){this.packageName="",this.packageAuthor="",this.load()},getPackageDetailInfoButton(e,t,a){this.packageIdInDialog=e,this.packageNameInDialog=t,this.packageConnectedDetailId=a,this.request.post("/servicePackageDetailInfo/getServicePackageDetailInfoById",{params:{packageConnectedDetailId:this.packageConnectedDetailId}}).then((e=>{"200"===e.code&&(this.packageDetailDialogFormVisible=!0,this.packageDetailInfo=e.data)}))},checkPackageButton(e,t,a,i){this.packageIdInDialog=e,this.packageNameInDialog=t,this.packageConnectedDetailId=i,"待审核"===a?(this.checkPackageDialogFormVisible=!0,this.setCheckInterval()):"已拒绝"===a?this.$message.error("审核拒绝的资源包，无法再进行安全扫描"):"待发布"===a&&this.$message.success("此资源包已经通过安全扫描了")},runCheckProgressValue(){if(this.checkProgressValue>=100);else{let e=Math.round(10*Math.random());e+this.checkProgressValue>=100?this.checkProgressValue=100:this.checkProgressValue=this.checkProgressValue+e}},setCheckInterval(){this.checkTimer=setInterval(this.runCheckProgressValue,200)},cancelCheckPackageButton(){this.cancelCheckPackageDialogFormVisible=!0},continueCheckPackageButton(){this.cancelCheckPackageDialogFormVisible=!1},yesCancelCheckPackageButton(){this.cancelCheckPackageDialogFormVisible=!1,this.checkPackageDialogFormVisible=!1,this.checkProgressValue=0,clearInterval(this.checkTimer)},async checkFinishButton(){await this.request.post("/pendingReviewPackage/checkedById",{params:{packageId:this.packageIdInDialog,operator:this.user,servicePackageDetailInfoId:this.packageConnectedDetailId}}).then((e=>{"200"===e.code?this.$message.success(e.msg):this.$message.warning("系统异常，操作失败")})),await this.load(),this.checkPackageDialogFormVisible=!1},refusePackageButton(e,t,a,i){this.packageIdInDialog=e,this.packageNameInDialog=t,this.packageConnectedDetailId=i,"已拒绝"===a?this.$message.error("这个资源包已经被拒绝过了"):this.refusePackageDialogFormVisible=!0},async refusePackage(){await this.request.post("/pendingReviewPackage/refuseById",{params:{packageId:this.packageIdInDialog,operator:this.user,servicePackageDetailInfoId:this.packageConnectedDetailId}}).then((e=>{"200"===e.code?this.$message.success(e.msg):this.$message.warning("系统异常，操作失败")})),await this.load(),this.refusePackageDialogFormVisible=!1},publicPackageButton(e,t,a,i){this.packageIdInDialog=e,this.packageNameInDialog=t,this.packageConnectedDetailId=i,"已拒绝"===a?this.$message.error("已拒绝的资源包无法进行发布。"):"待审核"===a?this.$message.warning("资源包发布前请先进行安全检查。"):"待发布"===a&&(this.publishPackageDialogFormVisible=!0)},async publishPackage(){await this.request.post("/pendingReviewPackage/publishById",{params:{packageId:this.packageIdInDialog,operator:this.user,servicePackageDetailInfoId:this.packageConnectedDetailId}}).then((e=>{"200"===e.code?this.$message.success(e.msg):this.$message.warning("系统异常，操作失败")})),await this.load(),this.publishPackageDialogFormVisible=!1}}},o=l,c=a(3736),n=(0,c.Z)(o,i,s,!1,null,"f056c8a2",null),r=n.exports}}]);
//# sourceMappingURL=80.8bfa5dc3.js.map