"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[381],{4381:function(e,r,s){s.r(r),s.d(r,{default:function(){return g}});var t=function(){var e=this,r=e._self._c;return r("div",{staticClass:"MainBackground"},[r("div",{staticStyle:{"padding-top":"0px","flex-grow":"2"}}),r("div",{staticStyle:{position:"relative",width:"300px",height:"300px","background-color":"rgba(77,90,217,0.57)",padding:"10px",margin:"0 auto",top:"20%","border-radius":"5px"}},[e._m(0),r("el-form",{ref:"userForm",attrs:{model:e.user,rules:e.rules}},[r("el-form-item",{attrs:{prop:"username"}},[r("el-input",{staticStyle:{margin:"10px 0"},attrs:{size:"medium","prefix-icon":"el-icon-user"},model:{value:e.user.username,callback:function(r){e.$set(e.user,"username",r)},expression:"user.username"}})],1),r("el-form-item",{attrs:{prop:"password"}},[r("el-input",{staticStyle:{margin:"10px 0"},attrs:{size:"medium","prefix-icon":"el-icon-lock","show-password":""},model:{value:e.user.password,callback:function(r){e.$set(e.user,"password",r)},expression:"user.password"}})],1),r("el-form-item",{staticStyle:{margin:"10px 0","text-align":"right"}},[r("el-button",{attrs:{type:"warning",size:"small",autocomplete:"off"},on:{click:function(r){e.registerFormVisible=!0}}},[e._v("注册 ")]),r("el-button",{attrs:{type:"primary",size:"small",autocomplete:"off"},on:{click:e.login}},[e._v("登录")])],1)],1)],1),r("el-dialog",{attrs:{title:"注册新的普通用户",visible:e.registerFormVisible,width:"500px"},on:{"update:visible":function(r){e.registerFormVisible=r}}},[r("el-form",{ref:"registerForm",attrs:{model:e.registerForm,rules:e.registerFormRules}},[r("el-form-item",{attrs:{label:"新用户名",prop:"newUserName","label-width":e.formLabelWidth,required:""}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.registerForm.newUserName,callback:function(r){e.$set(e.registerForm,"newUserName",r)},expression:"registerForm.newUserName"}})],1),r("el-form-item",{attrs:{label:"用户密码",prop:"newPassword","label-width":e.formLabelWidth,required:""}},[r("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:e.registerForm.newPassword,callback:function(r){e.$set(e.registerForm,"newPassword",r)},expression:"registerForm.newPassword"}})],1),r("el-form-item",{attrs:{label:"重复密码",prop:"newPasswordAgainst","label-width":e.formLabelWidth,required:""}},[r("el-input",{attrs:{autocomplete:"off","show-password":""},model:{value:e.registerForm.newPasswordAgainst,callback:function(r){e.$set(e.registerForm,"newPasswordAgainst",r)},expression:"registerForm.newPasswordAgainst"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(r){e.registerFormVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.register}},[e._v("确 定")])],1)],1)],1)},i=[function(){var e=this,r=e._self._c;return r("div",{staticStyle:{margin:"10px","text-align":"center","font-size":"24px",position:"relative"}},[r("b",{staticStyle:{"font-size":"25px",color:"white"}},[e._v("边缘开设系统")]),r("br"),r("b",{staticStyle:{"font-size":"20px",color:"white"}},[e._v("应用市场固定云控制台")])])}],a=(s(1703),s(3948),s(4239),{name:"Login",data(){let e=(e,r,s)=>{if(""===r)s(new Error("必填项，不可为空"));else{let e=r.match(/(^[A-Za-z0-9]+$)/);e?s():s(new Error("只允许使用英文字母和数据"))}},r=(e,r,s)=>{""===r?s(new Error("请再次输入密码")):r!==this.registerForm.newPassword?s(new Error("两次输入密码不一致!")):s()};return{note:{backgroundImage:"url("+s(2018)+")",backgroundRepeat:"no-repeat",backgroundSize:"100%",marginTop:"0px",height:"100%"},user:{},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{validator:e,trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:e,trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}]},registerFormVisible:!1,registerForm:{newUserName:"",newPassword:"",newPasswordAgainst:""},formLabelWidth:"120px",registerFormRules:{newUserName:[{required:!0,message:"请输入用户名",trigger:"blur"},{validator:e,trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],newPassword:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:e,trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],newPasswordAgainst:[{required:!0,message:"请重复输入密码",trigger:"blur"},{validator:e,trigger:"blur"},{validator:r,trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}]}}},methods:{checkForm(e){return new Promise(((r,s)=>{this.$refs[e].validate((e=>{e?r():s()}))}))},register(){let e=[];e.push(this.checkForm("registerForm")),Promise.all(e).then((()=>{this.request.post("/user/register",{params:{registerForm:this.registerForm}}).then((e=>{"200"===e.code?(this.$message.success("注册成功，现在可以登录了"),this.registerFormVisible=!1,this.registerForm.newUserName="",this.registerForm.newPassword="",this.registerForm.newPasswordAgainst=""):this.$message.error(e.msg)}))})).catch((()=>{this.$message.error("注册失败，存在同名用户")}))},login(){this.$refs["userForm"].validate((e=>{e&&this.request.post("/user/login",this.user).then((e=>{"200"!==e.code?this.$message.error("用户名或密码错误"):"200"===e.code&&(window.sessionStorage.setItem("userAccount",e.data.username),window.sessionStorage.setItem("userRole",e.data.role),this.$router.push("/home"),this.$message.success("登录成功，身份："+e.data.username+" 权限："+e.data.role),this.getPendingReviewPackageAsideNumber(),this.getPublishedPackageAsideNumber(),this.getRemovedPackageAsideNumber())}))}))},getPendingReviewPackageAsideNumber(){this.request.get("/pendingReviewPackage/getPendingPackageAsideNumber").then((e=>{this.$store.commit("setPendingPackageNumber",e.data)}))},getPublishedPackageAsideNumber(){this.request.get("/publishedPackage/getPublishedPackageAsideNumber").then((e=>{this.$store.commit("setPublishedPackageNumber",e.data)}))},getRemovedPackageAsideNumber(){this.request.get("/removedPackage/getRemovedPackageAsideNumber").then((e=>{this.$store.commit("setRemovedPackageNumber",e.data)}))}}}),o=a,l=s(3736),n=(0,l.Z)(o,t,i,!1,null,null,null),g=n.exports},2018:function(e,r,s){e.exports=s.p+"img/loginPic.282c67b4.png"}}]);
//# sourceMappingURL=381.74081ca9.js.map